<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—É—Ä–Ω–∏—Ä–∞ - {{ bot_name }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); 
                 color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .results-table { background: white; border-radius: 15px; overflow: hidden; 
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .table-header { background: #28a745; color: white; padding: 15px; text-align: center; }
        .player-row { display: grid; grid-template-columns: 60px 1fr 80px 80px 100px 80px; 
                     padding: 15px; border-bottom: 1px solid #eee; align-items: center; }
        .player-row:nth-child(even) { background: #f8f9fa; }
        .place { font-size: 1.2em; font-weight: bold; text-align: center; }
        .place.winner { color: #28a745; }
        .match-input { background: #e3f2fd; padding: 20px; border-radius: 15px; 
                      margin-bottom: 20px; text-align: center; }
        .btn { background: #28a745; color: white; padding: 12px 30px; border: none; 
              border-radius: 8px; cursor: pointer; font-size: 16px; margin: 0 10px; }
        .btn:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—É—Ä–Ω–∏—Ä–∞</h1>
            <h2>{{ tournament.name }}</h2>
        </div>
        <div class="match-input">
            <h3>üéÆ –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–∞</h3>
            
            <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 20px;">
                <!-- –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ü–û–ò–°–ö -->
                <form method="POST" action="/tournament_results/{{ tournament.id }}" style="flex: 1; max-width: 400px;">
                    <input type="hidden" name="search_method" value="auto">
                    <h4 style="color: #28a745; margin-bottom: 10px;">ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫</h4>
                    <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                        –°–∏—Å—Ç–µ–º–∞ –Ω–∞–π–¥–µ—Ç –º–∞—Ç—á –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —Ç—É—Ä–Ω–∏—Ä–∞
                    </p>
                    <button type="submit" class="btn" style="background: #28a745; width: 100%;">
                        üîç –ù–∞–π—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    </button>
                </form>
                
                <!-- –†–£–ß–ù–û–ô –ü–û–ò–°–ö -->
                <form method="POST" action="/tournament_results/{{ tournament.id }}" style="flex: 1; max-width: 400px;">
                    <input type="hidden" name="search_method" value="manual">
                    <h4 style="color: #667eea; margin-bottom: 10px;">üìù –†—É—á–Ω–æ–π –ø–æ–∏—Å–∫</h4>
                    <input type="text" name="match_id" placeholder="–í–≤–µ–¥–∏—Ç–µ Match ID –∏–∑ PUBG" 
                        style="padding: 10px; width: 100%; border-radius: 5px; border: 1px solid #ddd; margin-bottom: 10px;">
                    <button type="submit" class="btn" style="background: #667eea; width: 100%;">
                        üìä –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ ID
                    </button>
                </form>
            </div>
        </div>

        <!-- DEBUG: results = {{ results|length if results else 'None' }} -->
        {% if results %}
        <div class="results-table">
            <div class="table-header">
                <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–∞</h3>
            </div>
            <div class="player-row" style="background: #28a745; color: white; font-weight: bold;">
                <div>–ú–µ—Å—Ç–æ</div>
                <div>–ò–≥—Ä–æ–∫</div>
                <div>–£–±–∏–π—Å—Ç–≤–∞</div>
                <div>–£—Ä–æ–Ω</div>
                <div>–í—Ä–µ–º—è</div>
                <div>–°—Ç–∞—Ç—É—Å</div>
            </div>
            
            {% for player in results %}
            <div class="player-row">
                <div class="place {% if loop.index <= tournament.prize_places %}winner{% endif %}">
                    {{ player.placement }}
                </div>
                <div>
                    <strong>{{ player.player_name }}</strong>
                    {% if player.site_username %}
                        <br><small style="color: #666;">–°–∞–π—Ç: {{ player.site_username }}</small>
                    {% endif %}
                </div>
                <div>{{ player.kills }}</div>
                <div>{{ player.damage }}</div>
                <div>{{ player.survival_time }}</div>
                <div>
                    {% if loop.index <= tournament.prize_places %}
                        <span style="background: #28a745; color: white; padding: 3px 8px; border-radius: 10px; font-size: 12px;">
                            üèÜ –ü–†–ò–ó–ï–†
                        </span>
                    {% else %}
                        <span style="color: #666;">–£—á–∞—Å—Ç–Ω–∏–∫</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div style="text-align: center; margin-top: 20px;">
            <a href="/tournament/{{ tournament.id }}" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Ç—É—Ä–Ω–∏—Ä—É</a>
        </div>
    </div>
</body>
</html>